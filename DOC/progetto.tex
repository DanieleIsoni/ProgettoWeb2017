\input{header}
\chapter{Tecnologie utilizzate}
\lipsum
\chapter{Database}

\chapter{Librarie incluse}


\chapter{Autocompletamento}

L'autocompletamento presente nella barra di ricerca è stato realizzato mediante la libreria JavaScript  \textbf{bootstrap-ajax-typeahead}, la quale recupera i suggerimenti per l'autocompletamento dalla servlet AutoCompleteServlet mediante richieste Ajax, a cui la servlet rispone in formato JSON.

La servlet effettua una ricerca per similarità (secondo l'algoritmo di Jaro-Winkler) all'interno di una lista, la quale viene caricata all'avvio dell'applicazione analizzando i nomi dei prodotti presenti nel database e aggiornata a intervalli prestabiliti (ogni 30 minuti) mediante le classi Executors e ScheduledExecutorService presenti all'interno di Java stesso.

Abbiamo scelto questa implementazione per evitare di sovraccaricare il database eseguendo una query a ogni richiesta di autocompletamento (e quindi a ogni tasto premuto).
Un'altra opzione, poi scartata, era aggiornare la lista dell'autocompletamento a ogni modifica della tabella dei prodotti, ma questo avrebbe rallentato ogni operazione sulla tabella stessa.

L'algoritmo di Jaro-Winkler è utilizzato anche durante la scansione del database, per evitare di inserire nella lista dei suggerimenti titoli doppi o troppo simili (ad esempio ``frigo'' e ``frigorifero'') dato che questi verrebbero comunque selezionati al momento della ricerca, dove è applicata ancora una volta la similarità.

\chapter{Risultati della ricerca}
la ricerca tra i prodotti è realizzata mediante una servlet che elabora la richiesta e restituisce la lista dei prodotti sottoforma di JSON. L'unico parametro obbligatorio è \texttt{q} che rappresenta la query di ricerca.
I parametri opzionali sono:
\begin{itemize}
  \item \texttt{p}: la pagina desiderata (nel caso di  una ricerca multipagina)
  \item \texttt{s}: il metodo di ordinamento dei risultati, di default alfabetico (0), alfagetico inverso(1), prezzo crescente (2), prezzo decrescente(3), valutazione decrescente(4),  numero recensioni decrescente(5).
  \item \texttt{c}: la categoria
  \item \texttt{min} e \texttt{max}: gli estremi dei prezzi.
  \item \texttt{minRev}: il minimo del valore delle recensioni.
\end{itemize}
Il controllo sul nome del prodotto e sul range di prezzo è effettuato all'interno del DAO del prodotto (mediante SQL per il prezzo e algoritmo di Jaro-Winkler per il nome), mentre il controllo sulla categoria e sul valore minimo della media delle recensioni è effettuato mediante un predicato invocato dal metodo \texttt{removeIf} della lista prodotti.
Oltre alla lista prodotti nel risultato sono restituiti anche il numero di pagine, il tipo di ordinamento usato e la pagina corrente.

\chapter{Dettagli implementativi}
\section{Orari di apertura e negozi solo online}
Per semplificare la struttura del DB abbiamo deciso di implementare i vari punti vendita dei negozi come una relazione uno a molti tra \texttt{shop} e \texttt{coordinate}. All'interno della tabella \texttt{coordinate} abbiamo inserito il campo \texttt{opening_hours} che contiene gli orari del punto vendita, nel caso in cui per il cliente sia disponibile il ritiro in negozio. Nel caso di negozi che effettuano soltanto vendita online questo campo resta vuoto e viene sostituito all'interno della pagina web con un messaggio che specifica le modalità di vendita solo online del negozio.
\chapter{Altri capitoli}
\chapter{Conclusioni}
\end{document}
